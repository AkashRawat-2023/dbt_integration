
WITH active_employees AS (
  SELECT * 
 FROM {{source('AKASH','ACTIVE_EMPLOYEES')}}
)
SELECT
FTV_ID,
PERSON_DISPLAY_NAME,
EMAIL_ADDRESS,
PERSON_TYPE,
WORKER_TYPE,
HOURLY_SALARIED,
DATE_OF_BIRTH,
AGE,
ASSIGNMENT_STATUS,
ASSIGNMENT_CURRENT_EFFECTIVE_DATE,
ASSIGNMENT_CURRENT_CHG_ACTION,
ASSIGNMENT_CURRENT_CHG_REASON,
ASSIGNMENT_EMPLOYMENT_CATEGORY,
SEGMENT,
OPCO,
SUB_OPCO,
LEGAL_ENTITY_NAME,
BUSINESS_UNIT_NAME,
DEPARTMENT_NAME,
COST_CENTER,
ASSIGNMENT_NAME,
NVL(JOB_TITLE,'NA') AS JOB_TITLE,
NVL(JOB_FUNCTION,'NA') AS JOB_FUNCTION,
NVL(JOB_FAMILY,'NA') AS JOB_FAMILY,
NVL(EEO_CATEGORY,'NA') AS EEO_CATEGORY,
NVL(CAREER_BAND,'NA') AS CAREER_BAND,
NVL(CAREER_LEVEL,'NA') AS CAREER_LEVEL,
GRADE_NAME,
FTE,
ORIGINAL_HIRE_DATE,
LATEST_HIRE_DATE,
ADJUSTED_SERVICE_DATE,
LENGTH_OF_SERVICE,
L1_LEADER,
MANAGER_FTV_ID,
NVL(WORK_REGION,'NA') AS WORK_REGION,
NVL(WORK_COUNTRY,'NA') AS WORK_COUNTRY,
NVL(WORK_STATE,'NA') AS WORK_STATE,
NVL(WORK_CITY,'NA') AS WORK_CITY,
NVL(WORK_LOCATION,'NA') AS WORK_LOCATION,
HEADCOUNT,
SALARY,
CURRENCY_CODE,
NVL(POTENTIAL_RATING,'NA') AS POTENTIAL_RATING,
NVL(PERFORMANCE_RATING,'NA') AS PERFORMANCE_RATING
FROM active_employees
